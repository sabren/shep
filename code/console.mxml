<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"  xmlns:base="*"
	layout="absolute" width="800" height="575" currentState="Title"
	creationComplete="addCallbacks()">
	<mx:states>
		<mx:State name="Game">
			<mx:SetProperty target="{gameCanvas}" name="visible" value="true"/>
			<mx:RemoveChild target="{image1}"/>
			<mx:RemoveChild target="{label1}"/>
			<mx:AddChild position="lastChild">
				<mx:Button label="Pause" right="2" top="2" click="pauseGame()" id="button1"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button label="Exit Level" right="148" top="2" click="currentState=&quot;LevelSelect&quot;" id="button3"/>
			</mx:AddChild>
			<mx:RemoveChild target="{button2}"/>
			<mx:AddChild relativeTo="{button3}" position="before">
				<mx:Button label="Restart" right="71" top="2" click="restartLevel()" id="button4"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button label="Time=0:05" right="237" top="2" click="gameCanvas.game.clock.startTimer(5)" id="button0"/>
			</mx:AddChild>
		</mx:State>
		<mx:State name="Title">
			<mx:AddChild position="lastChild">
				<mx:Button y="335" label="Start Game"  click="currentState=&quot;LevelSelect&quot;" enabled="true" width="224" fillAlphas="[0.9, 0.9, 0.9, 0.9]" horizontalCenter="-11"/>
			</mx:AddChild>
			<mx:SetProperty target="{image1}" name="source" value="@Embed(&quot;../assets/screens/title.png&quot;)"/>
			<mx:RemoveChild target="{label1}"/>
			<mx:SetProperty target="{button2}" name="x" value="277"/>
			<mx:SetProperty target="{button2}" name="y" value="365"/>
			<mx:SetProperty target="{button2}" name="width" value="224"/>
			<mx:SetStyle target="{button2}" name="fillAlphas" value="[0.9, 0.9, 0.9, 0.9]"/>
			<mx:AddChild position="lastChild">
				<base:Help x="150" y="108" id="helpBox" visible="false">
				</base:Help>
			</mx:AddChild>
			<mx:SetEventHandler target="{button2}" name="click" handler="helpBox.visible=true"/>
			<mx:SetProperty target="{image1}" name="autoLoad" value="true"/>
		</mx:State>
		<mx:State name="Pause" basedOn="Game">
			<mx:AddChild position="lastChild">
				<mx:Button x="364" y="216" label="Resume" click="resumeGame()"/>
			</mx:AddChild>
			<mx:RemoveChild target="{button1}"/>
			<mx:RemoveChild target="{button3}"/>
		</mx:State>
		<mx:State name="LevelSelect">
			<mx:RemoveChild target="{button2}"/>
			<mx:RemoveChild target="{label1}"/>
			<mx:RemoveChild target="{image1}"/>

			<mx:AddChild position="lastChild">
				<mx:Label x="32" y="27" text="CHOOSE SECTOR" fontWeight="bold" fontSize="24"/>
			</mx:AddChild>

			<mx:AddChild position="lastChild">
				<mx:Button x="32" y="100" label="0: Training" click="startLevel(0)" width="106"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button x="32" y="150" label="1 : _________" click="startLevel(1)"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button x="155" y="150" label="2 : _________" click="startLevel(2)"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button x="281" y="150" label="3 : _________" click="startLevel(3)"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button x="32" y="214" label="4 : _________" click="startLevel(4)"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button x="155" y="214" label="5 : _________" click="startLevel(5)"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button x="281" y="214" label="6 : _________" click="startLevel(6)" alpha="0.1"/>
			</mx:AddChild>
			<mx:AddChild>
				<mx:Button x="32" y="270" label="7 : _________" click="startLevel(7)" alpha="0.1"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button x="155" y="270" label="8 : _________" click="startLevel(8)" alpha="0.1"/>
			</mx:AddChild>
			
			<mx:AddChild position="lastChild">
				<mx:Button x="281" y="270" label="9 : _________" click="startLevel(9)" alpha="0.1"/>
			</mx:AddChild>

			<mx:AddChild position="lastChild">
				<mx:Label x="454" y="102" text="Sector 0: Training Room" fontWeight="bold"/>
			</mx:AddChild>

			<mx:AddChild position="lastChild">
				<mx:Image x="445" y="150" source="@Embed(&quot;../assets/0000-preview.png&quot;)" width="300" height="191"/>
			</mx:AddChild>
			
			<mx:AddChild position="lastChild">
				<mx:Label x="455" y="312" text="(preview would change as you mouseOver buttons)"/>
			</mx:AddChild>

		</mx:State>
		<mx:State name="GameOver">
			<mx:RemoveChild target="{label1}"/>
			<mx:RemoveChild target="{image1}"/>
			<mx:RemoveChild target="{button2}"/>
			<mx:AddChild position="lastChild">
				<mx:Button x="331.5" y="323" label="Choose Next Sector" click="currentState=&quot;LevelSelect&quot;"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Label x="260.5" y="150" text="Level Complete" fontSize="36" textAlign="center" id="label2"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{label2}" position="before">
				<mx:Button x="331.5" y="369" label="Replay Sector" click="restartLevel()" width="137"/>
			</mx:AddChild>
		</mx:State>
		<mx:State name="Victory" basedOn="GameOver">
			<mx:SetProperty target="{label2}" name="text" value="Sector Cleared!"/>
			<mx:AddChild position="lastChild">
				<mx:Label x="331.5" y="279" text="Time left: 01:26" fontWeight="bold"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Label x="331.5" y="254" text="Time Used: 00:34" fontWeight="bold"/>
			</mx:AddChild>
		</mx:State>
		<mx:State name="Defeat" basedOn="GameOver">
			<mx:SetProperty target="{label2}" name="text" value="Time Ran Out!"/>
		</mx:State>
	</mx:states>
	<mx:Image x="0" y="0" source="../assets/LoadingScreen.png" id="image1"/>
	<mx:Label y="36" text="Screen" fontSize="36" fontWeight="bold" fontFamily="Georgia" id="label1" horizontalCenter="0" textAlign="center"/>
	<mx:Button x="377" y="213" label="How to Play" id="button2"/>
	<base:GameCanvas id="gameCanvas" visible="false"/>			
	
	
<mx:Script>
<![CDATA[
  
  private function pauseGame():void {
    currentState="Pause";
    gameCanvas.game.pause();
  }
  
  private function resumeGame():void {
    currentState="Game";
    gameCanvas.game.resume();
  }
  
  private function restartLevel():void {
    currentState="Game";
    gameCanvas.game.restart();
  }

  private function startLevel(n:int):void {
    currentState="Game";
    gameCanvas.game.startLevel(n);
  }
  
  private function addCallbacks():void {
	var onWin:Function = function(timeCount:Number):void {
  		currentState="Victory";
	};
	var onLose:Function = function():void {
  		currentState="Defeat";
	}
	gameCanvas.init(onWin, onLose);
  }
]]>
</mx:Script>
</mx:Application>
