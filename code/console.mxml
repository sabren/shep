<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"  xmlns:base="*"
	layout="absolute" width="800" height="575" currentState="Title"
	creationComplete="addCallbacks()">
	<mx:states>
		<mx:State name="Game">
			<mx:SetProperty target="{gameCanvas}" name="visible" value="true"/>
			<mx:AddChild position="lastChild">
				<mx:Button click="pauseGame()" id="button1" width="71" bottom="1" right="1" height="24" fillAlphas="[0.0, 0.0, 0.0, 0.0]" themeColor="#FF0018" buttonMode="true"/>
			</mx:AddChild>
		</mx:State>
		<mx:State name="Title">
			<mx:AddChild position="lastChild">
				<mx:Image x="0" y="0" source="@Embed(&quot;../assets/screens/screen-bgs.png&quot;)"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Image x="0" y="0" source="@Embed(&quot;../assets/screens/title.png&quot;)"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button y="335" label="Start Game"  click="currentState=&quot;LevelSelect&quot;" enabled="true" width="224" fillAlphas="[0.9, 0.9, 0.9, 0.9]" horizontalCenter="-11"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<base:Help x="150" y="108" id="helpBox" visible="false">
				</base:Help>
			</mx:AddChild>
			<mx:AddChild relativeTo="{helpBox}" position="before">
				<mx:Button x="277" y="365" label="How to Play" id="button2" width="224" fillAlphas="[0.9, 0.9, 0.9, 0.9]" click="helpFrom(&quot;Title&quot;)"/>
			</mx:AddChild>
		</mx:State>
		<mx:State name="Pause" basedOn="Game">
			<mx:AddChild position="lastChild">
				<mx:Image x="0" y="0" source="@Embed(&quot;../assets/screens/paused.png&quot;)"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button x="288" y="360" label="Resume Game" click="resumeGame()" id="button7" fillAlphas="[0.9, 0.9, 0.9, 0.9]" width="224"/>
			</mx:AddChild>
			<mx:RemoveChild target="{button1}"/>
			<mx:AddChild position="lastChild">
				<mx:Button label="Restart Level" right="288" top="405" click="restartLevel()" id="button4" width="224" fillAlphas="[0.9, 0.9, 0.9, 0.9]"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button label="Exit Level" right="288" top="451" click="gameCanvas.game.done = true; currentState=&quot;LevelSelect&quot;" id="button3" width="224" fillAlphas="[0.9, 0.9, 0.9, 0.9]"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{button7}" position="before">
				<mx:Button x="288" y="498" label="How to Play" id="button0" width="224" fillAlphas="[0.9, 0.9, 0.9, 0.9]" click="helpFrom(&quot;Pause&quot;)"/>
			</mx:AddChild>
		</mx:State>
		<mx:State name="LevelSelect">
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Image x="0" y="0" source="@Embed(&quot;../assets/screens/level-select.png&quot;)"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Button x="342" y="138" click="startLevel(1)" width="144" height="84" fillAlphas="[0.0, 0.0, 0.0, 0.0]" alpha="0.0" buttonMode="true"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Button x="528" y="138" click="startLevel(2)" width="143" height="84" fillAlphas="[0.0, 0.0, 0.0, 0.0]" buttonMode="true" themeColor="#DDF6C7" alpha="0.0" fillColors="[#32922B, #32922B, #32922B, #32922B]"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Button x="157" y="247" click="startLevel(3)" width="143" height="85" fillAlphas="[0.0, 0.0, 0.0, 0.0]" alpha="0.0" buttonMode="true"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Button x="342" y="247" click="startLevel(4)" width="144" height="85" fillAlphas="[0.0, 0.0, 0.0, 0.0]" alpha="0.0" buttonMode="true"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Button x="528" y="247" click="startLevel(5)" width="143" height="85" fillAlphas="[0.0, 0.0, 0.0, 0.0]" alpha="0.0" buttonMode="true"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Button x="157" y="359" click="startLevel(6)" enabled="true" width="143" height="77" fillAlphas="[0.0, 0.0, 0.0, 0.0]" alpha="0.0" buttonMode="true"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Button x="342" y="359" click="startLevel(7)" enabled="true" width="144" height="77" fillAlphas="[0.0, 0.0, 0.0, 0.0]" alpha="0.0" buttonMode="true"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Button x="528" y="359" click="startLevel(9)" enabled="true" width="143" height="77" fillAlphas="[0.0, 0.0, 0.0, 0.0]" alpha="0.0" buttonMode="true"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Button x="157" y="138" click="startLevel(0)" width="143" height="84" fillAlphas="[0.0, 0.0, 0.0, 0.0]" alpha="0.0" buttonMode="true"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Button x="288.5" y="532" click="currentState=&quot;Title&quot;" fillAlphas="[0.0, 0.0, 0.0, 0.0]" color="#BDFF9D" alpha="0.0" buttonMode="true" width="248"/>
			</mx:AddChild>

		</mx:State>
		<mx:State name="GameOver">
			<mx:AddChild position="lastChild">
				<mx:Button x="331.5" y="431" label="Replay Level" click="restartLevel()" width="137" id="button5" fillAlphas="[0.9, 0.9, 0.9, 0.9]"/>
			</mx:AddChild>
			<mx:AddChild position="lastChild">
				<mx:Button x="331.5" y="484" label="Back to Map" click="currentState=&quot;LevelSelect&quot;" id="button6" width="137" fillAlphas="[0.9, 0.9, 0.9, 0.9]"/>
			</mx:AddChild>
		</mx:State>
		<mx:State name="Victory" basedOn="GameOver">
			<mx:SetProperty target="{button5}" name="label" value="Replay Level"/>
			<mx:AddChild relativeTo="{button5}" position="before">
				<mx:Image x="0" y="0" source="@Embed(&quot;../assets/screens/screen-bgs.png&quot;)"/>
			</mx:AddChild>
		    <mx:AddChild relativeTo="{button5}" position="before">
				<mx:Image x="0" y="0" source="@Embed(&quot;../assets/screens/victory.png&quot;)"/>
			</mx:AddChild>
		    <mx:SetProperty target="{button5}" name="y" value="406"/>
		    <mx:SetProperty target="{button6}" name="y" value="456"/>
		</mx:State>
		<mx:State name="Defeat" basedOn="GameOver">
			<mx:AddChild relativeTo="{button5}" position="before">
				<mx:Image x="0" y="0" source="@Embed(&quot;../assets/screens/gameover.png&quot;)"/>
			</mx:AddChild>
			<mx:SetProperty target="{button5}" name="label" value="Try Again"/>
			<mx:SetProperty target="{button6}" name="label" value="Back to Map"/>
			<mx:SetProperty target="{button6}" name="y" value="491"/>
			<mx:SetProperty target="{button5}" name="y" value="446"/>
			<mx:SetStyle target="{button5}" name="fillAlphas" value="[0.9, 0.9, 0.9, 0.9]"/>
			<mx:SetStyle target="{button6}" name="fillAlphas" value="[0.9, 0.9, 0.9, 0.9]"/>
		</mx:State>
		<mx:State name="Help">
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Image x="0" y="0" width="800" height="575" source="@Embed(&quot;../assets/screens/help.png&quot;)"/>
			</mx:AddChild>
			<mx:AddChild relativeTo="{starCanvas}" position="lastChild">
				<mx:Button x="708" y="538" width="82" height="27" alpha="0.0" fillAlphas="[0.0, 0.0, 0.0, 0.0]" buttonMode="true" click="back()"/>
			</mx:AddChild>
		</mx:State>
	</mx:states>
	<mx:Canvas id="starCanvas" visible="true"/>
	<base:GameCanvas id="gameCanvas" visible="false"/>			
	
	
<mx:Script>
<![CDATA[
  [Bindable]
  public var backToWhere:String;
  
  private function back():void {
  	currentState = backToWhere;
  }
  private function helpFrom(where:String):void {
  	backToWhere = where;
  	currentState = "Help";
  }
  
  private function pauseGame():void {
    currentState="Pause";
    gameCanvas.game.pause();
  }
  
  private function resumeGame():void {
    currentState="Game";
    gameCanvas.game.resume();
  }
  
  private function restartLevel():void {
    currentState="Game";
    gameCanvas.game.restart();
  }

  private function startLevel(n:int):void {
    currentState="Game";
    gameCanvas.game.startLevel(n);
  }
  
  private function addCallbacks():void {
	var onWin:Function = function(timeCount:Number):void {
  		currentState="Victory";
	};
	var onLose:Function = function():void {
  		currentState="Defeat";
	}
	gameCanvas.init(onWin, onLose, starCanvas);
  }
]]>
</mx:Script>
</mx:Application>
